# ================================================================================================
#  workshop
#  Copyright (C) 2022 Tim Leonard
# ================================================================================================
# This file just contains commonly used structures which are generic to specific shaders.
# ================================================================================================
type: shader
version: 1

render_states:
  # Default geometry rendering state.
  default: 
    cull_mode: none
  # Default geometry rendering state in wireframe.
  default_wireframe: 
    cull_mode: none
    fill_mode: wireframe 
  # Default render state but without depth testing enabled. Useful
  # for things such as fullscreen passes.
  no_depth_test:
    depth_test_enabled: false  
    depth_write_enabled: true
    cull_mode: none
  # Transparent geometry rendering state.
  transparent: 
    cull_mode: none  
    depth_write_enabled: false
    blend_enabled: true
    blend_op: add
    blend_source_op: source_alpha
    blend_destination_op: inverse_source_alpha
    blend_alpha_op: add
    blend_alpha_source_op: zero
    blend_alpha_destination_op: one

vertex_layouts:
  # Simple layout that contains only vert position and uv. Useful
  # for things like fullscreen passes.
  vertex2d_pos_uv:
    position: float2
    uv: float2

output_targets:
  # Main gbuffer target with all MRT targets.
  gbuffer:
    color: [ R16G16B16A16, R16G16B16A16_FLOAT, R16G16B16A16_FLOAT ]
    depth: D24_UNORM_S8_UINT
  # Swapchain output target.
  swapchain:
    color: [ R8G8B8A8 ]
  # Swapchain output target.
  swapchain_and_depth:
    color: [ R8G8B8A8 ]
    depth: D24_UNORM_S8_UINT
  # Light accumulation buffer.
  light_buffer:
    color: [ R16G16B16A16_FLOAT ]

param_blocks:
  # Contains all the parameters needed to read/write from the gbuffer.
  gbuffer:
    scope: global
    fields:
      gbuffer0_texture: texture2d
      gbuffer1_texture: texture2d
      gbuffer2_texture: texture2d
      gbuffer_sampler: sampler
  # Describes the projection information for the view being rendered.
  view_info:
    scope: global
    fields:
      view_matrix: float4x4
      projection_matrix: float4x4